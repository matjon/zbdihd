Dla skupienia uwagi możemy projektować pod tą komorę:
	http://www.klimatest.eu/katalog/leaflets/espec/Komory_serii_AR_v2_0.pdf
Można założyć (w sposób bardzo konserwatywny):
	- time slice W = 5 sekund,
	- że po wyłączeniu grzania temperatura w komorze się ustabilizuje w czasie 
	mniejszym niż 10 minut (czyli po K = 120 jednostkach czasu),
	- ew. można te parametry skorygować, tak żeby tę liczbę 120 zmniejszyć, 
	te wartości tutaj są dosyć wyśrubowane.
	
Na razie pomijamy chłodzenie, żeby uprościć problem. W sumie to jednak dosyć dobrze pasuje do różnych systemów HVAC, które mogą działać bez klimatyzatora (np. w zimie).

Mamy N zbiorów danych historycznych o postaci:
{kontekst, akcja, reakcja}
 - akcja - jaką czynność podjęliśmy w danej chwili,
 - kontekst - co działo się z układem przed podjęciem akcji,
 - reakcja - jakie były skutki podjętej akcji.

Największym problemem jest próba licznościowego uchwycenia reakcji.  
- nie da się prościej?
	- specjalne przebiegi uczące???
Na nią mogą bowiem wpływać decyzje podjęte później. Można to uchwycić matematycznie:

Dzielimy czas na jednostki o szerokości W. Zakładamy, że w obrębie każdej jednostki
moc grzałki oraz ew. innych urządzeń jest stała.
Kolejne jednostki są numerowane liczbami całkowitymi.

Rozważamy jednostkę o numerze j.

Przyrost temperatury podczas tej jednostki czasu jest równy:
∆T[j] = T[j+1] - T[j] ≈ \sum_{i=0}^{j} (ΔT[j] | P[i])

Gdzie:
	T[j] 	- temperatura na początku j-tej jednostki czasu,
	(ΔT[j] | P[i])
		- przyrost temperatury w j-tej jednostce czasu dzięki grzaniu w 
                i-tej jednostce czasu.
                - oczywiście j >= i

Jesteśmy w stanie bezpośrednio zmierzyć jedynie T[j], chcielibyśmy jednak znać
(ΔT[j] | P[i]).

Musimy więc założyć:
(ΔT[j] | P[i]) = P[i] * f(j-i)
 - gdzie P[i] - moc grzałki w danej jednostce czasu 
(bardziej chyba powinniśmy używać dostarczonego ciepła, ale to jest detal),
 - f(x)        
        - pewna funkcja dążąca do zera dla x dążącego do nieskończoności, 
         lim_{j -> +∞} (ΔT[j] | P[i]) = 0
        - zdefiniowana dla wartości nieujemnych,
        - f(0) - stosunek przyrostu temperatury w tym samym przedziale czasu kiedy
                 grzejemy do mocy grzałki 
                 (Jeśli przed obecnym przedziałem czasu układ znajdował się w
                 równowadze)
                 (dotyczy sytuacji kiedy przyrost temperatury jest w tej samej
                 jednostce czasu co grzanie)
        - po K = 120 okresach sytuacja się stabilizuje, z tego względu można
          uznać że f(x) ≡ 0 dla x >= K + 1)
                - czyli f(x) może być niezerowe dla x < K+1
                                                x <= K
                - istnieje co najwyżej K+1 niezerowych wartości funkcji f(x),
                - jeden okres przeznaczony na grzanie który nie wlicza się do
                  czasu stabilizacji oraz K okresów przez które temperatura 
                  się stabilizuje
                //wyliczyłem to na kartce z nr 6 i zweryfikowałem niezależnie
                // na kartce nr 7
 	
Mamy więc po podstawieniu:
∆T[j] = T[j+1] - T[j] ≈ \sum_{i=0}^{j} P[i] * f(j-i)

Po przyjęciu że f(x) ≡ 0 dla x >= K + 1 mamy:
∆T[j] = T[j+1] - T[j] ≈ \sum_{i=j-K}^{j} P[i] * f(j-i)
        - czyli wewnętrzna suma przechodzi przez K + 1 wartości, zgadza się

Rozważymy teraz postać sumy dla niskich wartości j:
j = 0
∆T[0] = T[1] - T[0] ≈ \sum_{i=0}^{0} (ΔT[0] | P[i]) = (ΔT[0] | P[0]) = P[0] * f(0)
∆T[0] = T[1] - T[0] ≈ [P[0] * f(0)]

Dla j=1:
∆T[1] = T[2] - T[1] ≈ \sum_{i=0}^{1} (ΔT[1] | P[i]) = (ΔT[1] | P[0]) + (ΔT[1] | P[1]) = 
	= [ P[0] * f(1-0) + P[1] * f(1-1) ] = [ P[0] * f(1) + P[1] * f(0)]
∆T[1] = T[2] - T[1] ≈ [ P[0] * f(1) + P[1] * f(0)]


∆T[0] = T[1] - T[0] ≈ [P[0] * f(0)] 
∆T[1] = T[2] - T[1] ≈ [P[0] * f(1) + P[1] * f(0)]
∆T[2] = T[3] - T[2] ≈ [P[0] * f(2) + P[1] * f(1) + P[2] * f(0)]

Coś takiego nazywamy splotem (convolution).
http://en.wikipedia.org/wiki/Convolution#Discrete_convolution
∆T[2] = T[3] - T[2] ≈ (P * f)[2]

I ogólnie:
∆T[j] = T[j+1] - T[j] ≈ (P * f)[j]

W tym wypadku przy definicji splotu pomijamy składniki dla których f(x) = 0.

Mamy więc układ równań:
∆T[j] = T[j+1] - T[j] ≈ \sum_{i=j-K}^{j} P[i] * f(j-i) = 

    j
=   ∑   P[i] f(j-i)
  i=j-K

Mamy tutaj K+1 niewiadomych - tyle ile niezerowych wartości funkcji f().
Dodatkowo, dla każdej danej historycznej (pary wartości P[i], T[i]) 
mamy zazwyczaj jedno równanie.
Jeżeli jednak system przy rozpoczęciu zbierania danych nie znajdował sie w stanie
równowagi termodynamicznej, musimy odrzucić pierwsze K pomiarów.

Można by rozwinąć:
f(x) = g(x) * e^{-t/T} * c_1
Przy czym 
	g(x) < 1
	g(0) = 1	(tak żeby c_1 ustalić na sztywno)
T - jakaś liczba.

Może być jednak problem z uwzględnieniem g(x) < 1 przy rozwiązywaniu tego układu równań (mogłoby to wymagać innych metod).

-----------------------------
Zakładając że znamy wartości funkcji f (wyliczone z powyższego układu równań), możemy skonstruować rekordy danych historycznych:

Podobnie jak poprzednio, rozważamy j-ty rekord danych historycznych, dotyczący grzania w j-tym przedziale czasu,
- kontekst:
	- ∑_{i=j-119}^{j} ΔT[i]/t
	- ∑_{i=j-119}^{j} ΔT[i]/(t^2)
	- ∑_{i=j-120}^{j-1} P[i]/t
	- ∑_{i=j-120}^{j-1} P[i]/(t^2)
	- ewentualnie T[j]
	
- akcja:
	P[j]
- reakcja:
	Zdefiniujmy (ΔT[j-1] || P[i]) - przyrost temperatury który da się przypisać grzaniu w j-tej jednostce czasu,
	(ΔT[j-1] || P[i]) =
		- nie wiem jak go wyliczyć, ale to powinno być proste, później się tym zajmę.
		- po prostu brakuje mi wyobraźni
	
	- rekord zawierałby całki takie same jak dla kontekstu, z tym że dla (ΔT[j-1] || P[i]) i oczywiście indeksy wartości byłyby większe od j, znaczy się sumowane wszystko byłoby w przód,
	
	- albo może po prostu surowe przebiegi (ΔT[j-1] || P[i]) 
	

-----------------------------	
Dobra, mając N ***pełnych*** rekordów historycznych (znaczy się takich które zostały sporządzone więcej niż 120 okresów temu, tak że reakcje są w pełni wyliczone).
 - w sumie można ograniczyć to do rekordów które były dawno, tak żeby nie było jakichś dziwnych (i trudnych do uchwycenia) interakcji między tym co się teraz dzieje a tym co było w niedawnej historii i co wpływa bezpośrednio na obecne decyzje.
 
Jesteśmy w chwili czasu i, mamy historię oraz przyszłość do decyzji.
(zmienne dobieram tak żeby intuicyjnie i <= j)

Oznaczenia:
	i - obecna chwila czasu, którą analizujemy
	j - indeksuje czas w którym przewidujemy że będziemy grzać,
	k - indeksuje temperaturę w przyszłości,
	
- na podstawie historii oraz wartości funkcji f liczymy zmiany temp w przyszłości które wynikają z tego co już grzaliśmy,
- mamy residualną krzywą temperaturową,
	
	
- musimy do niej jakoś dopasować obecne przebiegi,
	- można założyć po prostu
		(ΔT[j] | P[i]) = P[i] * f(j-i)	//w starych oznaczeniach
		//na nowe oznaczenia:	j->k, i->j
		(ΔT[k] | P[j]) = P[j] * f(k-j)
		//TODO: wszędzie powyżej: j->k, i->j
		
		i w ten sposób przewidzieć przyszłość na kilka(naście?) najbliższych okresów, poprzez zwykły układ równań / coś zbliżonego do progr. liniowego:
		Niech U[k] = żądana temperatura w na początku przedziału czasowego j
		
T[j] ≈ T[j-1] + \sum_{i=0}^{j-1} (ΔT[j-1] | P[i])	//stare oznaczenia

T[k] ≈ T[k-1] + \sum_{j=0}^{k-1} (ΔT[k-1] | P[j])
			//podstawiamy biorąc pod uwagę że powyżej jest k-1
T[k] ≈ T[k-1] + \sum_{j=0}^{k-1} P[j] * f(k-j-1)
Ponieważ zakładamy że f(x) dla x > 120 jest równy 0, mamy:
T[k] ≈ T[k-1] + \sum_{j=k-121}^{k-1} P[j] * f(k-j-1)
//dolny indeks sumowania sprawdziłem na kartce

//TODO: zapisywać to w ten sposób wszędzie:
ΔT[k-1] = T[k] - T[k-1] ≈ \sum_{j=k-121}^{k-1} P[j] * f(k-j-1)


ΔT[k-1] = T[k] - T[k-1] ≈ \sum_{j=k-121}^{k-1} P[j] * f(k-j-1)

 - przecież z przebiegów mamy żądane ΔU[k], takie jakie chcemy,
 - mamy więc układ równań: 
ΔT[k] = T[k] - T[k-1] ≈ \sum_{j=k-121}^{k-1} P[j] * f(k-j-1)
        dla k = i+1, do k = 121+1       - czyli 120 równań

        Niewiadome: 120 wartości P[j] - dla j = i (grzejemy w obecnej chwili)
                                        do j = i+119


niewiadome: P[j]

 		P[j
 			




	- ale jakoś korzystać z tej historii też,

	- tak jak ze sterowaniem rakietą, rakiety nie naprowadza się na konkretną trasę, po prostu w każdej jednostce czasu (time slice) wylicza się na podstawie obecnego położenia oraz innych czynników nową trasę, która trochę się różni od starej i po niej rakietę prowadzi.
	
	
	
	
	
	
	
	
	
	
	
	
	
TODO: Czekaj, przecież jest też chłodzenie przez ściany
	
Dawid Nowak
a czy my uwzględniamy tutaj temperaturę rzeczywistą, tzn. zmierzoną przez czujnik ?
dzieje się to aby na pewno dynamicznie ?
09:41
Ja
"dzieje się to aby na pewno dynamicznie ?" - nie rozumiem?
09:43
Dawid Nowak
bo np. jak włożymy do komory jakieś urządzenie do zbadania jak się zachowuje w różnych warunkach temperaturowych i jeżeli ono będzie emitować jakieś ciepło 
09:45
czy my bierzemy pod uwagę temperaturę w jakiejś chwili bieżącej t ?
czy tylko na podstawie danych historycznych ?
09:45
Ja
Ew. możemy założyć termistor, one mają b. dużą szybkość działania.
Zasadniczo wydaje mi się założenie że temp. na termistorze = taka jaką chcemy mieć.
09:46
Dawid Nowak
w sumie dowolny czujnik temperatury
09:46
Ja
Czyli nie przejmujemy się zbytnio tym że termistor mierzy "inną temperaturę" niż jest w komorze.
I tak różnice temp. wewnątrz komory są stosunkowo duże (wyżej jest oczywiście cieplej), musimy względem czegoś kalibrować / jakiegoś punktu.


//      vim: spelllang=pl
